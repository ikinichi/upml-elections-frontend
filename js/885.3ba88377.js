"use strict";(self["webpackChunkupml_elections"]=self["webpackChunkupml_elections"]||[]).push([[885],{4053:(e,t,n)=>{n.d(t,{Z:()=>s});const s={serverIp:"https://elections-backend-upml.herokuapp.com/"}},1192:(e,t,n)=>{n.d(t,{Z:()=>c});var s=n(3673);const a={class:"logo text-center"};function i(e,t,n,i,o,r){return(0,s.wg)(),(0,s.iD)("div",a,[(0,s.WI)(e.$slots,"default",{},void 0,!0)])}const o={username:"Logo"};var r=n(4260);const d=(0,r.Z)(o,[["render",i],["__scopeId","data-v-023d9bcf"]]),c=d},7885:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var s=n(3673),a=n(2323);const i={class:"q-my-lg"},o=(0,s.Uk)(" Выборы презедента ЮФМЛ "),r={class:"candidates-wrapper limiter flex column justify-center"},d={class:"candidates flex justify-center"},c={key:0,class:"congratulations"},l={class:"limiter q-my-md"},u={key:0,class:"votes flex column justify-center q-px-md"};function m(e,t,n,m,p,h){const g=(0,s.up)("Logo"),w=(0,s.up)("HeaderNavigation"),v=(0,s.up)("Candidate"),f=(0,s.up)("VotesDisplay"),y=(0,s.up)("q-layout");return(0,s.wg)(),(0,s.j4)(y,{class:"flex column justify-between items-center text-center"},{default:(0,s.w5)((()=>[(0,s._)("header",i,[(0,s._)("div",{class:(0,a.C_)(["limiter flex items-center",{"justify-between":2!==e.role,"justify-center":2===e.role}])},[(0,s.Wm)(g,{style:(0,a.j5)({"font-size":2===e.role?"2.5vw":""})},{default:(0,s.w5)((()=>[o])),_:1},8,["style"]),2!==e.role?((0,s.wg)(),(0,s.j4)(w,{key:0})):(0,s.kq)("",!0)],2)]),(0,s._)("section",r,[(0,s._)("div",d,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(p.candidates,((e,t)=>((0,s.wg)(),(0,s.j4)(v,{key:e,candidate:e,color:h.candidatesColors[t]},null,8,["candidate","color"])))),128))])]),p.winnerName?((0,s.wg)(),(0,s.iD)("h2",c,"Поздравляем "+(0,a.zw)(h.morphName(e.name=p.winnerName[0],e.surname=p.winnerName[1],e.gender=p.winnerName[2]))+" с победой!",1)):(0,s.kq)("",!0),(0,s._)("div",l,[e.isVoted||e.isVoteDisplayShown?((0,s.wg)(),(0,s.iD)("section",u,[(0,s.Wm)(f,{colors:h.candidatesColors,candidates:p.candidates},null,8,["colors","candidates"])])):(0,s.kq)("",!0)])])),_:1})}var p=n(1192);const h=e=>((0,s.dD)("data-v-55c9440d"),e=e(),(0,s.Cn)(),e),g={key:0},w={key:1},v=h((()=>(0,s._)("a",{href:"/login"},"Вход",-1))),f=[v];function y(e,t,n,i,o,r){return e.sessionId?((0,s.wg)(),(0,s.iD)("nav",g,[(0,s._)("h6",null,(0,a.zw)(o.name),1)])):((0,s.wg)(),(0,s.iD)("nav",w,f))}var k=n(52),_=n.n(k),I=n(4053),j=n(3617);const C={username:"HeaderNavigation",mounted(){console.log(this.sessionId),_().get(I.Z.serverIp+"user-name/"+this.sessionId).then((e=>{this.name=e.data.name}))},data(){return{name:null}},computed:{...(0,j.Se)("mainStore",["sessionId"])}};var x=n(4260);const D=(0,x.Z)(C,[["render",y],["__scopeId","data-v-55c9440d"]]),S=D,Z={key:0,class:"candidate-wrapper flex column justify-center items-center"},b={class:"candidate shadow-10 flex column justify-center items-center"},q={class:"image-wrapper flex column justify-center"},V=["src"],N={class:"q-my-sm"},z=(0,s.Uk)(" Проголосовать ");function W(e,t,n,i,o,r){const d=(0,s.up)("q-btn");return n.candidate.name.includes("Против")&&2===e.role?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Z,[(0,s._)("div",b,[(0,s._)("div",q,[(0,s._)("img",{src:o.serverIp+n.candidate.image,alt:"Фото кондидата"},null,8,V)]),(0,s._)("h4",N,(0,a.zw)(n.candidate.name+" "+n.candidate.surname),1),(0,s._)("div",{class:"color-line",style:(0,a.j5)({"background-color":n.color})},null,4)]),e.sessionId&&!e.isVoted&&2!==e.role?((0,s.wg)(),(0,s.j4)(d,{key:0,style:(0,a.j5)({"background-color":n.color}),class:"q-mt-md",onClick:r.vote},{default:(0,s.w5)((()=>[z])),_:1},8,["style","onClick"])):(0,s.kq)("",!0)]))}const $={username:"Elected",props:{candidate:{default:{name:"Voloďa",surname:"Simkin",image:"http://www.rosphoto.com/images/u/articles/1510/4_8.jpg",offlineVotes:1e4,onlineVotes:1e4}},color:{default:"red"}},data(){return{serverIp:I.Z.serverIp}},methods:{...(0,j.OI)("mainStore",["mutateVote"]),vote(){_().post(I.Z.serverIp+"vote/",{session_id:this.sessionId,candidate_id:this.candidate.candidateId}).then((e=>{console.log(e)})).catch((e=>{console.log(e)})),this.mutateVote()}},computed:{...(0,j.Se)("mainStore",["sessionId","isVoted","role"])}};var L=n(4607),P=n(7518),H=n.n(P);const T=(0,x.Z)($,[["render",W],["__scopeId","data-v-602ee134"]]),M=T;function E(e,t,n,i,o,r){return(0,s.wg)(),(0,s.iD)("div",{class:"votes-display",style:(0,a.j5)({"grid-template-columns":`repeat(${r.columnsTemplate})`,"grid-template-rows":`repeat(${r.rowsTemplate})`})},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.candidatesCount,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"candidate-bar-part flex items-center justify-center text-center",key:e,style:(0,a.j5)({"background-color":this.colors[e-1]})},(0,a.zw)(this.candidatesPercentage[e-1][1].toFixed(1)+"%"),5)))),128))],4)}H()($,"components",{QBtn:L.Z});const O={username:"VotesDisplay",props:{colors:{required:!0},candidates:{required:!0}},mounted(){this.$nextTick((()=>{window.addEventListener("resize",this.onResize)})),_().get(I.Z.serverIp+"percentage/").then((e=>{this.candidatesPercentage=e.data}))},data(){return{windowWidth:window.innerWidth,candidatesPercentage:null}},methods:{onResize(){this.windowWidth=window.innerWidth}},computed:{candidatesCount(){return this.candidates?Object.keys(this.candidates).length:0},gridSettings(){if(this.candidatesPercentage){let e=`${this.candidatesCount},`;return console.log(this.candidatesPercentage),e+this.candidatesPercentage.map((e=>e[1])).join("% ")+"%"}return null},rowsTemplate(){return this.windowWidth<768?this.gridSettings:"1, auto"},columnsTemplate(){return this.windowWidth<768?"1, auto":this.gridSettings}},beforeUnmount(){window.removeEventListener("resize",this.onResize)}},R=(0,x.Z)(O,[["render",E],["__scopeId","data-v-c472f950"]]),U=R;var K=n(5249);function Q(e,t,n){n/=100;const s=t*Math.min(n,1-n)/100,a=t=>{const a=(t+e/30)%12,i=n-s*Math.max(Math.min(a-3,9-a,1),-1);return Math.round(255*i).toString(16).padStart(2,"0")};return`#${a(0)}${a(8)}${a(4)}`}const Y={username:"IndexLayout",components:{Logo:p.Z,HeaderNavigation:S,Candidate:M,VotesDisplay:U},mounted(){setInterval((()=>{document.location.reload()}),12e4),_().get(I.Z.serverIp+"candidates/").then((e=>{this.candidates=e.data})),_().get(I.Z.serverIp+"winner-name/").then((e=>{this.winnerName=e.data}))},data(){return{candidates:null,width:null,winnerName:""}},methods:{generateCandidatesColors(e){let t=[],n=e;for(let s=0;s<n;s++)t.push(Q(360*s/n,72,51));return t},morphName(e,t,n){n=n?"male":"female";let s={gender:n,first:e,last:t},a=K(s,"accusative");return a.first+" "+a.last}},computed:{...(0,j.Se)("mainStore",["sessionId","isVoted","isVoteDisplayShown","isNameShown","role"]),candidatesColors(){return this.candidates?this.generateCandidatesColors(Object.keys(this.candidates).length):this.generateCandidatesColors(10)}}};var B=n(4899);const F=(0,x.Z)(Y,[["render",m],["__scopeId","data-v-1953bca1"]]),A=F;H()(Y,"components",{QLayout:B.Z})}}]);