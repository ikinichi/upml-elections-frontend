"use strict";(self["webpackChunkupml_elections"]=self["webpackChunkupml_elections"]||[]).push([[135],{4053:(e,t,a)=>{a.d(t,{Z:()=>n});const n={serverIp:"https://elections-backend-upml.herokuapp.com/"}},9135:(e,t,a)=>{a.r(t),a.d(t,{default:()=>E});var n=a(3673);const s=e=>((0,n.dD)("data-v-cf6149c8"),e=e(),(0,n.Cn)(),e),i={key:0,class:"limiter flex column justify-center items-center"},d=s((()=>(0,n._)("h3",null,"Создать кандидата",-1))),l=(0,n.Uk)("Добавить кандидата"),o={class:"form-wrapper flex justify-center"},c={class:"flex q-my-sm"},m={class:"change-votes-btns flex column reverse"},u=(0,n.Uk)("Удалить Кандидата"),g={key:1,class:"unautorised flex column justify-center items-center text-center"},p=s((()=>(0,n._)("h1",null,"У вас недостаточно полномочий",-1))),r=[p];function h(e,t,a,s,p,h){const f=(0,n.up)("q-btn"),S=(0,n.up)("q-input"),V=(0,n.up)("q-file"),L=(0,n.up)("q-select"),C=(0,n.up)("q-form"),v=(0,n.up)("q-checkbox"),k=(0,n.up)("q-layout");return(0,n.wg)(),(0,n.j4)(k,null,{default:(0,n.w5)((()=>[0!==e.role?((0,n.wg)(),(0,n.iD)("div",i,[d,(0,n.Wm)(f,{color:"primary",onClick:h.addCandidate},{default:(0,n.w5)((()=>[l])),_:1},8,["onClick"]),(0,n._)("div",o,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(p.candidatesSettingsList,((e,t)=>((0,n.wg)(),(0,n.j4)(C,{class:"candidate-settings float column justify-center q-ma-md",key:e,onSubmit:e=>h.changeCandidateData(t)},{default:(0,n.w5)((()=>[(0,n.Wm)(S,{modelValue:p.candidatesSettingsList[t].name,"onUpdate:modelValue":[e=>p.candidatesSettingsList[t].name=e,e=>h.changeCandidateData(t)],label:"Имя кандидата",rules:[e=>!!e||"Поле обязательное"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,n.Wm)(S,{modelValue:p.candidatesSettingsList[t].surname,"onUpdate:modelValue":[e=>p.candidatesSettingsList[t].surname=e,e=>h.changeCandidateData(t)],label:"Фамилия кандидата",rules:[e=>!!e||"Поле обязательное"]},null,8,["modelValue","onUpdate:modelValue","rules"]),(0,n.Wm)(V,{modelValue:p.candidatesSettingsList[t].image,"onUpdate:modelValue":[e=>p.candidatesSettingsList[t].image=e,e=>h.changeCandidateData(t)],accept:".jpg, .png, image/*",label:"Новое фото кандидата"},null,8,["modelValue","onUpdate:modelValue"]),(0,n.Wm)(L,{modelValue:p.candidatesSettingsList[t].gender,"onUpdate:modelValue":[e=>p.candidatesSettingsList[t].gender=e,e=>h.changeCandidateData(t)],options:p.selectOptions,label:"Пол"},null,8,["modelValue","onUpdate:modelValue","options"]),(0,n._)("div",c,[(0,n.Wm)(S,{modelValue:p.candidatesSettingsList[t].offlineVotes,"onUpdate:modelValue":[e=>p.candidatesSettingsList[t].offlineVotes=e,e=>h.changeCandidateData(t)],label:"Количество очных голосов"},null,8,["modelValue","onUpdate:modelValue"]),(0,n._)("div",m,[(0,n.Wm)(f,{icon:"expand_more",onClick:e=>h.changeOfflineVotes(t,"-")},null,8,["onClick"]),(0,n.Wm)(f,{icon:"expand_less",onClick:e=>h.changeOfflineVotes(t,"+")},null,8,["onClick"])])]),(0,n.Wm)(f,{icon:"close",onClick:e=>h.deleteCandidate(t)},{default:(0,n.w5)((()=>[u])),_:2},1032,["onClick"])])),_:2},1032,["onSubmit"])))),128))]),(0,n.Wm)(v,{label:"Подвести итоги","onUpdate:modelValue":[t[0]||(t[0]=e=>h.toggleEnd()),t[1]||(t[1]=e=>p.isEnded=e)],modelValue:p.isEnded,"model-value":p.isEnded},null,8,["modelValue","model-value"])])):((0,n.wg)(),(0,n.iD)("div",g,r))])),_:1})}a(8880);var f=a(1959);const S={name:"CreateCandidate",data(){return{name:(0,f.iH)(null)}}};var V=a(4260),L=a(4689),C=a(1052),v=a(4554),k=a(4607),w=a(7518),I=a.n(w);I()(S,"components",{QInput:L.Z,QFile:C.Z,QIcon:v.Z,QBtn:k.Z});var _=a(52),y=a.n(_),Z=a(4053),D=a(3617);const b={name:"Admin",mounted(){this.isVoteDisplayChecked=this.isVoteDisplayShown,this.isNameShowed=this.isNameShown,y().get(Z.Z.serverIp+"candidates/").then((e=>{for(let t in e.data)e.data[t].gender?e.data[t].gender="Мужской":e.data[t].gender="Женский";this.candidatesSettingsList=e.data})).catch((e=>{console.log(e)})),y().get(Z.Z.serverIp+"is-ended/").then((e=>{this.isEnded=e.data}))},data(){return{candidatesCount:0,candidatesSettingsList:[],isVoteDisplayChecked:null,isNameShowed:null,candidatesShow:[],isEnded:!1,selectOptions:["Мужской","Женский"]}},methods:{...(0,D.OI)("mainStore",["toggleVoteDisplay","toggleNameShow","changeCandidatesShown","changeWinnerName"]),changeOfflineVotes(e,t){"+"===t?this.candidatesSettingsList[e].offlineVotes++:this.candidatesSettingsList[e].offlineVotes--,this.changeCandidateData(e)},addCandidate(){y().post(Z.Z.serverIp+"add-empty-candidate",{session_id:this.sessionId}).then((e=>{this.candidatesSettingsList.push({candidateId:e.data[0],name:"",surname:"",image:"",offlineVotes:0,gender:"Мужской"})}))},toggleEnd(){this.isEnded=!this.isEnded,y().post(Z.Z.serverIp+"toggle-end",{session_id:this.sessionId}).then((e=>{this.changeWinnerName(e.data),console.log(e.data)}))},deleteCandidate(e){y().post(Z.Z.serverIp+"delete-candidate/",{session_id:this.sessionId,candidate_id:this.candidatesSettingsList[e].candidateId}),this.candidatesSettingsList.splice(e,1)},changeCandidateData(e){console.log(this.candidatesSettingsList[e].candidateId,this.sessionId,this.candidatesSettingsList[e].name,this.candidatesSettingsList[e].surname,this.candidatesSettingsList[e].offlineVotes,"Мужской"==this.candidatesSettingsList[e].gender?1:0);let t=new FormData;t.append("candidate_id",this.candidatesSettingsList[e].candidateId),t.append("session_id",this.sessionId),t.append("name",this.candidatesSettingsList[e].name),t.append("surname",this.candidatesSettingsList[e].surname),t.append("gender","Мужской"===this.candidatesSettingsList[e].gender?1:0),this.candidatesSettingsList[e].image&&"string"!==typeof this.candidatesSettingsList[e].image&&t.append("image",this.candidatesSettingsList[e].image),t.append("offline_votes",this.candidatesSettingsList[e].offlineVotes),y().post(Z.Z.serverIp+"change-candidate/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{console.log(e)}))}},computed:{...(0,D.Se)("mainStore",["sessionId","isVoteDisplayShown","isNameShown","role"])}};var U=a(4899),W=a(8689),Q=a(7308),x=a(1420);const q=(0,V.Z)(b,[["render",h],["__scopeId","data-v-cf6149c8"]]),E=q;I()(b,"components",{QLayout:U.Z,QBtn:k.Z,QForm:W.Z,QInput:L.Z,QFile:C.Z,QSelect:Q.Z,QCheckbox:x.Z})}}]);